-- Migrate to Version 0 
ALTER VIEW `journeys fare`  AS SELECT `journeys`.`boarding time stamp` AS `boarding time stamp`, `journeys`.`type` AS `type`, `journeys`.`network` AS `network`, `journeys`.`route` AS `route`, `journeys`.`destination` AS `destination`, `journeys`.`boarding place` AS `boarding place`, `journeys`.`alighting place` AS `alighting place`, `journeys`.`distance` AS `distance`, `journeys`.`time taken` AS `time taken`, `journeys`.`speed` AS `speed`, `is fully ticketed`(`journeys`.`serial`) AS `fully ticketed`, `get tickets count`(`journeys`.`serial`) AS `tickets count`, (select sum(`ticket apportion`.`fare`) from `ticket apportion` where `ticket apportion`.`journey serial` = `journeys`.`serial` and `ticket apportion`.`currency` = 'GBP') AS `fare`, (select sum(`ticket apportion`.`fare`) from `ticket apportion` where `ticket apportion`.`journey serial` = `journeys`.`serial` and `ticket apportion`.`currency` = 'GBP') / `journeys`.`distance` AS `fare per km` FROM `journeys` WHERE `is fully ticketed`(`journeys`.`serial`) AND !exists(select 0 from `ticket apportion` where `ticket apportion`.`journey serial` = `journeys`.`serial` AND `ticket apportion`.`currency` <> 'GBP')ORDER BY `journeys`.`boarding time stamp` desc  ;
